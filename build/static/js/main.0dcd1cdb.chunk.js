(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{15:function(e,n,t){e.exports=t(38)},37:function(e,n,t){},38:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(14),c=t.n(o),u=t(4),s=t(2);var l=function(e){var n=e.props,t=n.addPerson,a=n.handleNameChange,o=n.handleNumberChange;return r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"name: ",r.a.createElement("input",{onChange:a})),r.a.createElement("div",null,"number: ",r.a.createElement("input",{onChange:o})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"add")))};var i=function(e){var n=e.props.handleSearch;return r.a.createElement("div",null,"filter shown with: ",r.a.createElement("input",{onChange:n}))},m=t(3),d=t.n(m),f="/api/persons";var p=function(e){var n=e.props,t=n.persons,a=n.per,o=n.setPersons,c=n.setErrorMessage,u=n.setError;return r.a.createElement("div",null,a.name,a.number," ",r.a.createElement("button",{onClick:function(){var e;window.confirm("Delete ".concat(a.name,"?"))&&(e=a.id,d.a.delete("".concat(f,"/").concat(e)).then((function(e){return e.data}))).then((function(e){var n=t.filter((function(e){return e.id!==a.id}));u(!1),c("Deleted ".concat(a.name)),setTimeout((function(){c(null)}),5e3),o(n)})).catch((function(e){c("Information of ".concat(a.name," has already been removed from the server")),u(!0),setTimeout((function(){c(null)}),5e3)}))}}," delete ")," ")};var h=function(e){var n=e.props,t=n.setPersons,a=n.persons,o=n.search,c=n.setErrorMessage,u=n.setError;return r.a.createElement("div",null,a.filter((function(e){return-1!==e.name.toLowerCase().indexOf(o.toLowerCase())})).map((function(e,n){return r.a.createElement(p,{key:n,props:{per:e,persons:a,setPersons:t,setErrorMessage:c,setError:u}})})))};var b=function(e){var n=e.message,t=e.error;return null===n?null:r.a.createElement("div",{className:t?"error":"alert"},n)},E=function(){var e=Object(a.useState)(""),n=Object(s.a)(e,2),t=n[0],o=n[1],c=Object(a.useState)(""),m=Object(s.a)(c,2),p=m[0],E=m[1],v=Object(a.useState)(""),g=Object(s.a)(v,2),O=g[0],j=g[1],w=Object(a.useState)([]),S=Object(s.a)(w,2),C=S[0],k=S[1],y=Object(a.useState)(null),N=Object(s.a)(y,2),P=N[0],M=N[1],x=Object(a.useState)(!1),D=Object(s.a)(x,2),J=D[0],T=D[1];Object(a.useEffect)((function(){console.log("effect"),d.a.get(f).then((function(e){return e.data})).then((function(e){console.log("promise fulfilled"),k(e)}))}),[]);return r.a.createElement("div",null,r.a.createElement(b,{message:P,error:J}),r.a.createElement("h2",null,"Phonebook"),r.a.createElement(i,{props:{handleSearch:function(e){j(e.target.value)}}}),r.a.createElement("h2",null,"add a new"),r.a.createElement(l,{props:{addPerson:function(e){e.preventDefault();var n,a=C.find((function(e){return e.name===t}));if(void 0===a)(n={name:t,number:p},d.a.post(f,n).then((function(e){return e.data}))).then((function(e){k(C.concat(e)),T(!1),M("Added ".concat(e.name))})).catch((function(e){var n=(new DOMParser).parseFromString(e.response.data,"text/xml");console.log("err",e.response.data),console.log("dom",n),M(JSON.stringify(e.response.data)),T(!0)})),setTimeout((function(){M(null)}),5e3);else if(a&&p){var r=Object(u.a)(Object(u.a)({},a),{},{number:p});window.confirm("".concat(t," is already added to phonebook, replace the old number with the new one?"))&&function(e,n){return d.a.put("".concat(f,"/").concat(e),n).then((function(e){return e.data}))}(a.id,r).then((function(e){k(C.map((function(e){return e.id!==a.id?e:r}))),T(!1),M("updated ".concat(e.name,"'s number"))})).catch((function(e){T(!0),M(JSON.stringify(e.response.data))})),setTimeout((function(){M(null)}),5e3)}else alert("".concat(t," is already in the phonebook"))},handleNameChange:function(e){o(e.target.value)},handleNumberChange:function(e){E(e.target.value)}}}),r.a.createElement("h2",null,"Numbers"),r.a.createElement(h,{props:{setPersons:k,persons:C,search:O,setErrorMessage:M,setError:T}}))};t(37);c.a.render(r.a.createElement(E,null),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.0dcd1cdb.chunk.js.map